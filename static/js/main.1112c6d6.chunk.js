(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,r,t){},16:function(e,r,t){},18:function(e,r,t){},20:function(e,r,t){"use strict";t.r(r);var a=t(0),n=t.n(a),o=t(2),c=t.n(o),s=(t(14),t(3)),i=t(4),u=t(7),l=t(5),d=t(8),g=t(6),m=(t(16),function(){for(var e,r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];(e=console).log.apply(e,["[Local debugger]"].concat(t))}),p=(t(18),window.mapboxgl),L=function(e,r){return[e,r]},y=function(e,r){return[e[0]-r[0],e[1]-r[1]]},k=function(e,r){return[e[0]+r[0],e[1]+r[1]]},f={1910:{url:"./compressed-maps/1910-smaller.jpg",corners:[[-122.25368381624293,37.87666271788129],[-122.25205864680986,37.8690054551667],[-122.26567321115618,37.867273073426304],[-122.26725246910868,37.87479602627526]]},"1979-baldwin":{url:"./compressed-maps/1979-baldwin.jpg",corners:[[-122.27246573870457,37.87077721085865],[-122.25556530361206,37.88257575090472],[-122.2441424865603,37.87273856363721],[-122.26074299964147,37.86081212396496]]}},S=function(e){return e},v=function(e){var r=Object(g.a)(e,2);return{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[r[0],r[1]]}}},w=[-122.259491,37.873931],b={container:"map",zoom:13,minZoom:11,maxZoom:18,style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:128}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:24}]},maxBounds:[L(-122.552,37.673),L(-122.0467,37.987)],customAttribution:"Satellite map source: Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",center:w},h="localhost"===window.location.hostname,O=function(e){function r(){var e,t;return Object(s.a)(this,r),(e=Object(u.a)(this,Object(l.a)(r).call(this))).imageOverlayAdded=!1,e.sources={},e.state={},e.lastMarkerUpdate=0,e.currentOverlaySourceName=null,e.addSource=function(r,t){e.sources[r]||(e.sources[r]=e.map.addSource(r,{type:"image",url:S(f[r].url),coordinates:f[r].corners}))},e.setImageOverlay=function(r){e.imageOverlayAdded||(e.imageOverlayAdded=!0,e.currentOverlaySourceName=r,e.map.addLayer({id:"imageOverlay",source:r,type:"raster",paint:{"raster-opacity":.8}}))},e.setImage=function(r){var t=f[r];if(!t)throw new Error("Scan doesnt exist:",r);e.currentSource=r,e.addSource(r,t.corners),e.setImageOverlay(r),e.setMarkers(t.corners)},e.setMarkers=function(r){h&&(e.markers[0].setLngLat(r[0]),e.markers[1].setLngLat(r[1]),e.markers[2].setLngLat(r[2]),e.markers[3].setLngLat(r[3]))},e.updateCornersAutomated=function(){e.updateCorners(!1,!0)},e.updateCorners=function(r,t){if(null!=e.currentSource)if(!r&&Date.now()-e.lastMarkerUpdate<300)t||setTimeout(e.updateCornersAutomated,300-Date.now()-e.lastMarkerUpdate+2);else{e.lastMarkerUpdate=Date.now();var a=e.map.getSource(e.currentOverlaySourceName),n=f[e.currentOverlaySourceName];a.setCoordinates(n.corners),console.log("'".concat(e.currentOverlaySourceName,"': {url:'").concat(n.url,"', corners: [[").concat(n.corners[0][0],",").concat(n.corners[0][1],"], [").concat(n.corners[1][0],",").concat(n.corners[1][1],"], [").concat(n.corners[2][0],",").concat(n.corners[2][1],"], [").concat(n.corners[3][0],",").concat(n.corners[3][1],"],]},")),e.calculateBorders()}},e.updateScan=function(r,t,a){if(null!=e.currentSource){var n=e.map.getSource(e.currentOverlaySourceName),o=f[e.currentOverlaySourceName];n&&o?(o.corners[0]=[e.markers[0].getLngLat().lng,e.markers[0].getLngLat().lat],o.corners[1]=[e.markers[1].getLngLat().lng,e.markers[1].getLngLat().lat],o.corners[2]=[e.markers[2].getLngLat().lng,e.markers[2].getLngLat().lat],o.corners[3]=[e.markers[3].getLngLat().lng,e.markers[3].getLngLat().lat],e.updateCorners(a)):console.log("Something was empty",n,o)}},e.calculateBorders=function(){if(h){var r=[e.markers[0].getLngLat().lng,e.markers[0].getLngLat().lat],t=[e.markers[1].getLngLat().lng,e.markers[1].getLngLat().lat],a=[e.markers[2].getLngLat().lng,e.markers[2].getLngLat().lat],n=[e.markers[3].getLngLat().lng,e.markers[3].getLngLat().lat];e.map.getSource("borderTB").setData({type:"FeatureCollection",features:[v([a,k(a,y(r,t))]),v([n,k(n,y(t,r))]),v([r,k(r,y(a,n))]),v([t,k(t,y(n,a))])]}),e.map.getSource("borderLR").setData({type:"FeatureCollection",features:[v([n,k(n,y(t,a))]),v([r,k(r,y(a,t))]),v([t,k(t,y(n,r))]),v([a,k(a,y(r,n))])]})}},e.setupMap=function(){t=e.map,h&&(e.markers=[new p.Marker({draggable:!0,color:"#003262"}),new p.Marker({draggable:!0,color:"#3B7EA1"}),new p.Marker({draggable:!0,color:"#FDB515"}),new p.Marker({draggable:!0,color:"#C4820E"})],e.markers[0].on("drag",function(){return e.updateScan(0,e.markers[0].getLngLat())}),e.markers[1].on("drag",function(){return e.updateScan(1,e.markers[1].getLngLat())}),e.markers[2].on("drag",function(){return e.updateScan(2,e.markers[2].getLngLat())}),e.markers[3].on("drag",function(){return e.updateScan(3,e.markers[3].getLngLat())}),e.markers[0].on("dragend",function(){return e.updateScan(0,e.markers[0].getLngLat(),!0)}),e.markers[1].on("dragend",function(){return e.updateScan(1,e.markers[1].getLngLat(),!0)}),e.markers[2].on("dragend",function(){return e.updateScan(2,e.markers[2].getLngLat(),!0)}),e.markers[3].on("dragend",function(){return e.updateScan(3,e.markers[3].getLngLat(),!0)}),e.markers[0].setLngLat(L(-122.27246573870457,37.87077721085865)).addTo(t),e.markers[1].setLngLat(L(-122.25556530361206,37.88257575090472)).addTo(t),e.markers[2].setLngLat(L(-122.2441424865603,37.87273856363721)).addTo(t),e.markers[3].setLngLat(L(-122.26074299964147,37.86081212396496)).addTo(t),t.addSource("borderTB",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),t.addLayer({id:"borderTB",type:"line",source:"borderTB",paint:{"line-color":"#003262","line-opacity":.5,"line-width":4}}),t.addSource("borderLR",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),t.addLayer({id:"borderLR",type:"line",source:"borderLR",paint:{"line-color":"#FDB515","line-opacity":.5,"line-width":4}}),e.calculateBorders()),t.on("click",function(e){m("".concat(e.lngLat))}),t.on("mousedown",function(){e.imageOverlayAdded&&t.setPaintProperty("imageOverlay","raster-opacity",.4)}),t.on("mouseup",function(){e.imageOverlayAdded&&t.setPaintProperty("imageOverlay","raster-opacity",.8)}),setTimeout(function(){e.setImage("1979-baldwin")},1e3),t.boxZoom.disable(),t.addControl(new p.NavigationControl),t.addControl(new p.AttributionControl({compact:!0}),"top-left")},e}return Object(d.a)(r,e),Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=new p.Map(b);this.map=e,window.map=e,this.map.on("load",this.setupMap)}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",{id:"map"}))}}]),r}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,r,t){e.exports=t(20)}},[[9,2,1]]]);
//# sourceMappingURL=main.1112c6d6.chunk.js.map