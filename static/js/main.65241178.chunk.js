(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,r,a){e.exports=a(24)},,,,,function(e,r,a){},,function(e,r,a){},,function(e,r,a){},,function(e,r,a){},,function(e,r,a){},,function(e,r,a){"use strict";a.r(r);var t=a(0),n=a.n(t),o=a(7),s=a.n(o),i=(a(14),a(1)),c=a(2),l=a(4),u=a(3),d=a(5),g=(a(16),a(8)),m=(a(18),a(20),window.mapboxgl),p=function(e,r){return[e,r]},L=function(e){return e.lng?[e.lng,e.lat]:e},k=function(e,r){return[L(e)[0]-L(r)[0],L(e)[1]-L(r)[1]]},y=function(e,r){return[L(e)[0]+L(r)[0],L(e)[1]+L(r)[1]]},h=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.reduce(function(e,r){return[r.lng+e[0],r.lat+e[1]]},[0,0]).map(function(e){return e/r.length})},f=.9,v={1910:{year:"1910",url:"./compressed-maps/1910-smaller.jpg",corners:[[-122.25368381624293,37.87666271788129],[-122.25205864680986,37.8690054551667],[-122.26567321115618,37.867273073426304],[-122.26725246910868,37.87479602627526]]},"1979-baldwin":{year:"1979",url:"./compressed-maps/1979-baldwin.jpg",corners:[[-122.27242632492538,37.87075445739155],[-122.25552588983287,37.88255299743762],[-122.24401514609337,37.87263226468354],[-122.26089919151718,37.86083689391005]]}},w=function(e){return e},b=function(e){var r=Object(g.a)(e,2);return{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[r[0],r[1]]}}},C=[-122.259491,37.873931],M={container:"map",zoom:13,minZoom:11,maxZoom:18,style:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:128}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:24}]},maxBounds:[p(-122.552,37.673),p(-122.0467,37.987)],customAttribution:"Satellite map source: Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",center:C},S="localhost"===window.location.hostname,O=function(e){function r(e){var a,t;return Object(i.a)(this,r),(a=Object(l.a)(this,Object(u.a)(r).call(this))).imageOverlayAdded=!1,a.sources={},a.state={},a.lastMarkerUpdate=0,a.lastCenterAverage=[0,0],a.currentOverlaySourceName=null,a.addSource=function(e,r){a.sources[e]||(console.log("adding source"),a.sources[e]=a.map.addSource(e,{type:"image",url:w(v[e].url),coordinates:v[e].corners}))},a.setImageOverlay=function(e){a.imageOverlayAdded?(t.getLayer("imageOverlay").source=e,console.log(t.getLayer("imageOverlay").paint["raster-opacity"]=f),t.setPaintProperty("imageOverlay","raster-opacity",f)):(a.imageOverlayAdded=!0,a.currentOverlaySourceName=e,a.map.addLayer({id:"imageOverlay",source:e,type:"raster",paint:{"raster-opacity":f}}))},a.setImage=function(e){var r=v[e];if(!r)throw new Error("Scan doesnt exist:",e);a.currentSource=e,a.addSource(e,r.corners),a.setImageOverlay(e),a.setNewMarkers(r.corners),a.updateCorners()},a.setNewMarkers=function(e){S&&(a.markers[0].setLngLat(e[0]),a.markers[1].setLngLat(e[1]),a.markers[2].setLngLat(e[2]),a.markers[3].setLngLat(e[3]),a.lastCenterAverage=h(a.markers[0].getLngLat(),a.markers[1].getLngLat(),a.markers[2].getLngLat(),a.markers[3].getLngLat()),a.markers[4].setLngLat(a.lastCenterAverage))},a.updateCornersAutomated=function(){a.updateCorners(!1,!0)},a.updateCorners=function(e,r){if(null!=a.currentSource)if(!e&&Date.now()-a.lastMarkerUpdate<300)r||setTimeout(a.updateCornersAutomated,300-Date.now()-a.lastMarkerUpdate+2);else{a.lastMarkerUpdate=Date.now();var t=a.map.getSource(a.currentOverlaySourceName),n=v[a.currentOverlaySourceName];t.setCoordinates(n.corners),console.log("'".concat(a.currentOverlaySourceName,"': ").concat(JSON.stringify(n,null,0))),a.setNewMarkers(n.corners),a.calculateBorders()}},a.handleMarkerChange=function(e,r,t){if(null!=a.currentSource){var n=a.map.getSource(a.currentOverlaySourceName),o=v[a.currentOverlaySourceName];if(n&&o){if(4===e){var s=k(r,a.lastCenterAverage);o.corners[0]=y(a.markers[0].getLngLat(),s),o.corners[1]=y(a.markers[1].getLngLat(),s),o.corners[2]=y(a.markers[2].getLngLat(),s),o.corners[3]=y(a.markers[3].getLngLat(),s)}else o.corners[0]=L(a.markers[0].getLngLat()),o.corners[1]=L(a.markers[1].getLngLat()),o.corners[2]=L(a.markers[2].getLngLat()),o.corners[3]=L(a.markers[3].getLngLat());a.updateCorners(t)}else console.log("Invariant breached Something was empty",n,o)}},a.calculateBorders=function(){if(S){var e=[a.markers[0].getLngLat().lng,a.markers[0].getLngLat().lat],r=[a.markers[1].getLngLat().lng,a.markers[1].getLngLat().lat],t=[a.markers[2].getLngLat().lng,a.markers[2].getLngLat().lat],n=[a.markers[3].getLngLat().lng,a.markers[3].getLngLat().lat];a.map.getSource("borderTB").setData({type:"FeatureCollection",features:[b([t,y(t,k(e,r))]),b([n,y(n,k(r,e))]),b([e,y(e,k(t,n))]),b([r,y(r,k(n,t))])]}),a.map.getSource("borderLR").setData({type:"FeatureCollection",features:[b([n,y(n,k(r,t))]),b([e,y(e,k(t,r))]),b([r,y(r,k(n,e))]),b([t,y(t,k(e,n))])]})}},a.setupMap=function(){t=a.map,S&&(a.markers=[new m.Marker({draggable:!0,color:"#003262"}),new m.Marker({draggable:!0,color:"#3B7EA1"}),new m.Marker({draggable:!0,color:"#FDB515"}),new m.Marker({draggable:!0,color:"#C4820E"}),new m.Marker({draggable:!0,color:"#FFFFFF"})],a.markers[0].on("drag",function(){return a.handleMarkerChange(0,a.markers[0].getLngLat())}),a.markers[1].on("drag",function(){return a.handleMarkerChange(1,a.markers[1].getLngLat())}),a.markers[2].on("drag",function(){return a.handleMarkerChange(2,a.markers[2].getLngLat())}),a.markers[3].on("drag",function(){return a.handleMarkerChange(3,a.markers[3].getLngLat())}),a.markers[4].on("drag",function(){return a.handleMarkerChange(4,a.markers[4].getLngLat())}),a.markers[0].on("dragend",function(){return a.handleMarkerChange(0,a.markers[0].getLngLat(),!0)}),a.markers[1].on("dragend",function(){return a.handleMarkerChange(1,a.markers[1].getLngLat(),!0)}),a.markers[2].on("dragend",function(){return a.handleMarkerChange(2,a.markers[2].getLngLat(),!0)}),a.markers[3].on("dragend",function(){return a.handleMarkerChange(3,a.markers[3].getLngLat(),!0)}),a.markers[4].on("dragend",function(){return a.handleMarkerChange(4,a.markers[4].getLngLat(),!0)}),a.markers[0].setLngLat(p(-122.27246573870457,37.87077721085865)).addTo(t),a.markers[1].setLngLat(p(-122.25556530361206,37.88257575090472)).addTo(t),a.markers[2].setLngLat(p(-122.2441424865603,37.87273856363721)).addTo(t),a.markers[3].setLngLat(p(-122.26074299964147,37.86081212396496)).addTo(t),a.markers[4].setLngLat(p(-122.26074299964147,37.86081212396496)).addTo(t),t.addSource("borderTB",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),t.addLayer({id:"borderTB",type:"line",source:"borderTB",paint:{"line-color":"#003262","line-opacity":.5,"line-width":4}}),t.addSource("borderLR",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),t.addLayer({id:"borderLR",type:"line",source:"borderLR",paint:{"line-color":"#FDB515","line-opacity":.5,"line-width":4}}),a.calculateBorders()),t.on("click",function(e){}),t.on("mousedown",function(){a.imageOverlayAdded&&t.setPaintProperty("imageOverlay","raster-opacity",.3)}),t.on("mouseup",function(){a.imageOverlayAdded&&t.setPaintProperty("imageOverlay","raster-opacity",f)}),setTimeout(function(){e.initialMap&&a.setImage(e.initialMap)},500),t.boxZoom.disable(),t.doubleClickZoom.disable(),t.addControl(new m.NavigationControl),t.addControl(new m.AttributionControl({compact:!0}),"top-left"),e.signup(function(e){a.setImage(e)})},a}return Object(d.a)(r,e),Object(c.a)(r,[{key:"componentDidMount",value:function(){var e=new m.Map(M);this.map=e,window.map=e,this.map.on("load",this.setupMap)}},{key:"render",value:function(){return n.a.createElement("div",{className:"Mapp"},n.a.createElement("div",{id:"map"}))}}]),r}(t.Component),A=(a(22),function(e){function r(e){var a;return Object(i.a)(this,r),(a=Object(l.a)(this,Object(u.a)(r).call(this))).scan=e.scan,a.scanId=e.scanId,a.props=e,a}return Object(d.a)(r,e),Object(c.a)(r,[{key:"render",value:function(){var e=this.scan;return n.a.createElement("div",{className:"SidebarItem ".concat(this.props.active?"is-active":"")},n.a.createElement("a",{href:"#".concat(this.scanId),className:"SidebarItem__label"},e.year))}}]),r}(t.Component)),j=function(e){function r(){var e;Object(i.a)(this,r),(e=Object(l.a)(this,Object(u.a)(r).call(this))).state={currentMap:""},e.notifyChild=null,e.signup=function(r){e.notifyChild=r};var a=window.location.hash.replace(/^#/,"");return v[a]?e.state.currentMap=a:(window.location.hash="#1979-baldwin",e.state.currentMap="1979-baldwin"),window.addEventListener("hashchange",function(){var r=window.location.hash.replace(/^#/,"");e.setState({currentMap:r}),e.notifyChild&&e.notifyChild(r)},!1),e}return Object(d.a)(r,e),Object(c.a)(r,[{key:"render",value:function(){var e=[];for(var r in v){var a=this.state.currentMap===r;e.push(n.a.createElement(A,{key:r,active:a,scanId:r,scan:v[r]}))}return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"App__sidebar"},e),n.a.createElement("div",{className:"App__mapp"},n.a.createElement(O,{initialMap:this.state.currentMap,signup:this.signup})))}}]),r}(t.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[9,2,1]]]);
//# sourceMappingURL=main.65241178.chunk.js.map